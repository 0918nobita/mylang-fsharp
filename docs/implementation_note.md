# 実装中に書き残したメモ

## 処理系全体の構成

- パーサ
- 静的検査
- コード生成

## パーサ

自作したパーサコンビネータ [`Parsec`](reference/parsec.html) を利用して、ソースコードを AST に変換するパーサを実装する

## 静的検査

現状では型チェッカの実装もできていないので以下は妄想

### 1. 各ソースファイルの概要確認

各ソースファイルでどんな名称の関数、モジュールが定義されているかを簡易チェックする

この時点では `{unknown}` という仮の静的型が設定される

呼び出すコードがあるけれど対応する定義が同一ファイルで見つからない場合は<br>
「他のモジュールからインポートされているもの」とみて記録したうえでスルー

### 2. モジュールの依存関係の解決

`import` , `export` 部分を解析し、他のモジュールとの依存関係を解決し、循環していないかもチェックする

このタイミングで定義位置が確認できなかった関数の呼び出し部分はコンパイルエラーとする

### 3. 各関数に対する厳密な型チェック

各関数の本体で厳密な型チェックを行う

## コード生成

TypeScript の AST に変換し、簡易的な自作 AST printer を用いて目的コードを生成する

Mylang における１モジュールは１つの ES Module と対応する

※ 将来的には SourceMap の生成にも対応したい (ブラウザの DevTools 上で Mylang のコードを見ながらデバッグできるので)

## 初回リリース (v0.1.0) の目標

- TypeScript コードの書き出し
- 文字リテラル
- 文字列リテラル
- 整数リテラル
- 整数同士の足し算
- 文字・文字列・整数を標準出力へ出力する組み込み関数
- 簡易的な型検査器
